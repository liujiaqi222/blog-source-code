---
title: 使用正则格式化时间
date: 2021-07-31 11:47:51
tags: 正则
---

具体的原理我也不太懂，但是能用就行。


```js
function dateFormat(date, format) {
    if (typeof date === "string") {
      var mts = date.match(/(\/Date\((\d+)\)\/)/);
      if (mts && mts.length >= 3) {
        date = parseInt(mts[2]);
      }
    }
    date = new Date(date);
    if (!date || date.toUTCString() == "Invalid Date") {
      return "";
    }
    var map = {
      "M": date.getMonth() + 1, //月份 
      "d": date.getDate(), //日 
      "h": date.getHours(), //小时 
      "m": date.getMinutes(), //分 
      "s": date.getSeconds(), //秒 
      "q": Math.floor((date.getMonth() + 3) / 3), //季度 
      "S": date.getMilliseconds() //毫秒 
    };
    format = format.replace(/([yMdhmsqS])+/g, function(all, t) {
      var v = map[t];
      if (v !== undefined) {
        if (all.length > 1) {
          v = '0' + v;
          v = v.substr(v.length - 2);
        }
        return v;
      } else if (t === 'y') {
        return (date.getFullYear() + '').substr(4 - all.length);
      }
      return all;
    });
    return format;
  }



console.log(dateFormat(Date.now(),'yyyy'));  //2021
console.log(dateFormat(Date.now(),'yyyy-MM-dd hh:mm'));  //2021-07-31 11:41
console.log(dateFormat(1627702957686,'yyyy-MM-dd hh:mm'));  //2021-07-31 11:41

```

